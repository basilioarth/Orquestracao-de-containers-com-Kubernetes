# Resumo da Aula sobre Anatomia de um Cluster Kubernetes

## Introdução
A aula explora a anatomia de um cluster Kubernetes, destacando a divisão entre o **Control Plane** e os **Nodes** (nós de trabalho). O professor apresenta o Control Plane como o "cérebro" do cluster, responsável por gerenciar e garantir o estado das aplicações, enquanto os nós executam as aplicações propriamente ditas. A aula foca nos componentes do Control Plane e introduz conceitos como pods, self-healing e a importância de aplicações stateless, com menção ao suporte para cenários stateful.

## Anatomia do Cluster Kubernetes
- **Divisão Principal**: O cluster Kubernetes é composto por:
  - **Control Plane**: O "cérebro" que gerencia o cluster, garantindo o estado desejado das aplicações.
  - **Nodes (Workers)**: Máquinas (físicas ou virtuais) que executam as aplicações em pods. São os nós de trabalho, distintos do Control Plane.
- **Separação Física**: O Control Plane e os nós são máquinas distintas. O Control Plane pode ter redundância para alta disponibilidade, enquanto os nós de trabalho executam as aplicações do usuário.

## Componentes do Control Plane
- **Kube API Server**:
  - Componente central que expõe a API do Kubernetes, permitindo comunicação entre o Control Plane e os nós.
  - Gerencia interações, como ações em resposta a problemas reportados pelos nós.
- **Kube Scheduler**:
  - Responsável por agendar pods (unidades que executam aplicações) em nós específicos.
  - Em caso de falha, o Scheduler tenta reagendar o pod em outro nó para manter o estado desejado.
- **Controller Manager**:
  - Observa o estado atual do cluster e compara com o estado desejado (similar ao conceito de Infrastructure as Code).
  - Realiza conciliações para corrigir discrepâncias, como reiniciar ou realocar aplicações.
- **ETCD**:
  - Banco de dados chave-valor que armazena o estado atual do cluster (metadados).
  - Crítico para o funcionamento do Kubernetes; sua perda pode "bugar" o cluster, exigindo backups em cenários não gerenciados.
- **Cloud Controller Manager (CCM)**:
  - Componente opcional, presente apenas em Kubernetes gerenciado (ex.: EKS, AKS, GKE).
  - Faz a ponte entre o Kubernetes e a API do provedor de nuvem, gerenciando recursos específicos da cloud.

## Conceitos-Chave
- **Pods**:
  - Unidades mínimas que executam aplicações no Kubernetes, similares às réplicas ou instâncias do ECS.
  - Pods do próprio Kubernetes rodam no Control Plane para gerenciá-lo, enquanto pods de aplicações rodam nos nós de trabalho.
- **Self-Healing (Autocura)**:
  - O Control Plane monitora o estado do cluster via ETCD e tenta corrigir problemas automaticamente (ex.: reiniciar ou realocar pods defeituosos).
  - Em cenários stateless, pods defeituosos são descartados, o que pode levar à perda de logs ou dados se não houver volumes persistentes.
- **Stateless vs. Stateful**:
  - Por padrão, o Kubernetes trabalha com aplicações stateless (sem estado), mas suporta aplicações stateful com volumes persistentes.
  - Sem volumes, dados como logs são perdidos ao descartar pods, reforçando a importância de volumes para persistência.

## Conclusão
A aula detalha a estrutura de um cluster Kubernetes, destacando o papel do **Control Plane** como o gerenciador central, com componentes como Kube API Server, Scheduler, Controller Manager, ETCD e o opcional Cloud Controller Manager. Esses elementos garantem a orquestração, a conciliação de estados e a resiliência do cluster via processos como self-healing. Os **nós de trabalho** executam as aplicações em pods, enquanto o Control Plane mantém o estado desejado. A aula reforça a natureza stateless padrão do Kubernetes, com suporte a cenários stateful, e prepara para a próxima sessão, que explorará os nós de trabalho em detalhes.



# Resumo da Aula sobre Anatomia de um Cluster Kubernetes

## Introdução
A aula explora a anatomia de um cluster Kubernetes, destacando a divisão entre o **Control Plane** e os **Nodes** (nós de trabalho). O professor apresenta o Control Plane como o "cérebro" do cluster, responsável por gerenciar e garantir o estado das aplicações, enquanto os nós executam as aplicações propriamente ditas. A aula foca nos componentes do Control Plane e introduz conceitos como pods, self-healing e a importância de aplicações stateless, com menção ao suporte para cenários stateful.

## Anatomia do Cluster Kubernetes
- **Divisão Principal**: O cluster Kubernetes é composto por:
  - **Control Plane**: O "cérebro" que gerencia o cluster, garantindo o estado desejado das aplicações.
  - **Nodes (Workers)**: Máquinas (físicas ou virtuais) que executam as aplicações em pods. São os nós de trabalho, distintos do Control Plane.
- **Separação Física**: O Control Plane e os nós são máquinas distintas. O Control Plane pode ter redundância para alta disponibilidade, enquanto os nós de trabalho executam as aplicações do usuário.

## Componentes do Control Plane
- **Kube API Server**:
  - Componente central que expõe a API do Kubernetes, permitindo comunicação entre o Control Plane e os nós.
  - Gerencia interações, como ações em resposta a problemas reportados pelos nós.
- **Kube Scheduler**:
  - Responsável por agendar pods (unidades que executam aplicações) em nós específicos.
  - Em caso de falha, o Scheduler tenta reagendar o pod em outro nó para manter o estado desejado.
- **Controller Manager**:
  - Observa o estado atual do cluster e compara com o estado desejado (similar ao conceito de Infrastructure as Code).
  - Realiza conciliações para corrigir discrepâncias, como reiniciar ou realocar aplicações.
- **ETCD**:
  - Banco de dados chave-valor que armazena o estado atual do cluster (metadados).
  - Crítico para o funcionamento do Kubernetes; sua perda pode "bugar" o cluster, exigindo backups em cenários não gerenciados.
- **Cloud Controller Manager (CCM)**:
  - Componente opcional, presente apenas em Kubernetes gerenciado (ex.: EKS, AKS, GKE).
  - Faz a ponte entre o Kubernetes e a API do provedor de nuvem, gerenciando recursos específicos da cloud.

## Conceitos-Chave
- **Pods**:
  - Unidades mínimas que executam aplicações no Kubernetes, similares às réplicas ou instâncias do ECS.
  - Pods do próprio Kubernetes rodam no Control Plane para gerenciá-lo, enquanto pods de aplicações rodam nos nós de trabalho.
- **Self-Healing (Autocura)**:
  - O Control Plane monitora o estado do cluster via ETCD e tenta corrigir problemas automaticamente (ex.: reiniciar ou realocar pods defeituosos).
  - Em cenários stateless, pods defeituosos são descartados, o que pode levar à perda de logs ou dados se não houver volumes persistentes.
- **Stateless vs. Stateful**:
  - Por padrão, o Kubernetes trabalha com aplicações stateless (sem estado), mas suporta aplicações stateful com volumes persistentes.
  - Sem volumes, dados como logs são perdidos ao descartar pods, reforçando a importância de volumes para persistência.

## Conclusão
A aula detalha a estrutura de um cluster Kubernetes, destacando o papel do **Control Plane** como o gerenciador central, com componentes como Kube API Server, Scheduler, Controller Manager, ETCD e o opcional Cloud Controller Manager. Esses elementos garantem a orquestração, a conciliação de estados e a resiliência do cluster via processos como self-healing. Os **nós de trabalho** executam as aplicações em pods, enquanto o Control Plane mantém o estado desejado. A aula reforça a natureza stateless padrão do Kubernetes, com suporte a cenários stateful, e prepara para a próxima sessão, que explorará os nós de trabalho em detalhes.

