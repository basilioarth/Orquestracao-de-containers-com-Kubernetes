# Resumo da Aula de Encerramento do Módulo de Kubernetes

## Introdução
A aula finaliza o módulo de Kubernetes, o maior do curso de DevOps, destacando duas dicas práticas para melhorar a produtividade e o gerenciamento de clusters: o uso do **alias `k`** para o comando `kubectl` e a ferramenta **Lens**, uma IDE para Kubernetes. A aula reforça a importância de dominar os comandos `kubectl` antes de adotar ferramentas gráficas, mas apresenta o **Lens** como uma solução para visualização e debugging. Além disso, oferece um *spoiler* dos próximos módulos do curso (Feature Flags, Cost Management, Blue-Green Deployment com **Argo Rollouts**) e recomenda revisar o conteúdo e consultar a documentação oficial do Kubernetes.

## Dicas de Produtividade
### 1. **Alias `k` para `kubectl`**
- **O que é**:
  - O comando `k` é um **alias** comum para `kubectl`, configurado no arquivo `.bashrc` ou `.zshrc` do terminal.
  - Exemplo: `k get pods -n widget` é equivalente a `kubectl get pods -n widget`.
- **Por que usar**:
  - Reduz a digitação, economizando tempo em comandos longos.
  - Amplamente adotado pela comunidade, sendo comum em ambientes profissionais.
- **Como configurar**:
  - Adicionar ao `.bashrc` ou `.zshrc`:
    ```bash
    alias k=kubectl
    ```
  - Após configurar, comandos como `k version`, `k get pods`, ou `k logs` funcionam como `kubectl`.
- **Observação**:
  - Durante o curso, o instrutor evitou usar `k` para reforçar o aprendizado de `kubectl`.
  - Recomenda-se entender os comandos `kubectl` antes de adotar o alias para evitar confusão.
- **Exemplo de uso**:
  - `k get pods -n widget`: Lista os pods no namespace `widget`.
  - `k version`: Exibe a versão do cliente e servidor Kubernetes.

### 2. **Lens: IDE para Kubernetes**
- **O que é**:
  - **Lens** é uma interface gráfica (IDE) para gerenciamento de clusters Kubernetes, simplificando visualização e debugging.
  - Integra-se ao arquivo `kubeconfig` (ex.: cluster **Kind** com nome `kind-ftr-k8s`) para acessar o cluster.
- **Funcionalidades**:
  - **Visão geral do cluster**:
    - Exibe uso de CPU, memória, e quantidade de **Pods** (depende do **Metrics Server** estar instalado).
    - Mostra **Control Plane** (nós mestres) e **Worker Nodes** com detalhes de uso de recursos.
  - **Gerenciamento de workloads**:
    - Lista **Pods**, **Deployments**, **ReplicaSets**, **Services**, **ConfigMaps**, e **Secrets**.
    - Exibe métricas como uso de CPU/memória, número de reinícios, e nós onde os **Pods** estão alocados.
  - **Logs e debugging**:
    - Permite visualizar logs de **Pods** diretamente, equivalente a `kubectl logs <pod-name> -n <namespace>`.
    - Abstrai comandos `kubectl`, facilitando o acesso a informações.
  - **Rede**:
    - Suporta **Port Forwarding** (ex.: acessar `/health` de um **Service**).
    - Visualiza configurações de **Services** e **Ingress**.
  - **Rollback**:
    - Exibe histórico de **ReplicaSets** (até 10 revisões por padrão).
    - Facilita o rollback para versões anteriores via interface gráfica, equivalente a `kubectl rollout undo deployment/widget-server -n widget`.
- **Vantagens**:
  - Interface intuitiva para visualizar o estado do cluster sem comandos manuais.
  - Mostra distribuição de **Pods** entre nós, útil para entender **afinidade** e **anti-afinidade** (conceitos de infraestrutura para redundância).
  - Exemplo: Se um **Pod** está no `worker` e outro no `worker2`, a falha de um nó não afeta a disponibilidade.
- **Dependências**:
  - Requer **Metrics Server** para métricas de CPU/memória.
  - Depende de um `kubeconfig` válido para conectar ao cluster.
- **Recomendação**:
  - Instalar e testar o **Lens** após dominar os comandos `kubectl`.
  - Usar como ferramenta complementar para aumentar a produtividade, não como substituto dos comandos.

### Outra Ferramenta Mencionada: **K9s**
- **O que é**:
  - Uma ferramenta de terminal (CLI) para gerenciamento de Kubernetes, semelhante ao **Lens**, mas sem interface gráfica completa.
  - Oferece uma interface interativa para visualizar e gerenciar **Pods**, **Deployments**, **Services**, etc.
- **Comparação com Lens**:
  - **K9s**: Mais leve, baseada em terminal, ideal para usuários que preferem CLI.
  - **Lens**: Interface gráfica, mais amigável para iniciantes e visualização detalhada.
- **Nota do Instrutor**:
  - O instrutor prefere o **Lens** e não usa **K9s**, mas reconhece sua popularidade na comunidade.
  - Recomenda testar ambas as ferramentas para encontrar a mais adequada.

## Rollback com ReplicaSet
- **Conceito**:
  - O **Deployment** mantém um histórico de **ReplicaSets** (padrão: até 10 revisões).
  - O comando `kubectl rollout undo deployment/<name> -n <namespace>` reverte para o **ReplicaSet** anterior.
  - Exemplo: `kubectl rollout undo deployment/widget-server -n widget` ou `k rollout undo deployment/widget-server -n widget`.
- **No Lens**:
  - A interface exibe todos os **ReplicaSets** associados ao **Deployment**.
  - Permite selecionar uma revisão específica para rollback, simplificando o processo.
- **Boa Prática: Evitar `latest`**:
  - Usar a tag `latest` em imagens de containers impede o rollback efetivo, pois a tag é mutável e pode ser sobrescrita.
  - Exemplo de problema:
    - Se a imagem `widget-server:latest` é atualizada, o rollback não restaura a versão anterior, pois a tag aponta para a nova imagem.
  - Solução: Usar tags específicas (ex.: `widget-server:1.0.0`, `widget-server:1.0.1`).
- **Image Pull Policy**:
  - Configurada como `IfNotPresent` no **Deployment** do curso, evita baixar a imagem se já estiver presente.
  - Com `latest`, isso pode impedir o rollback, pois a imagem local não é atualizada.
  - Recomendação: Usar `Always` com tags específicas para garantir controle de versão.

## Boas Práticas
- **Dominar `kubectl` Primeiro**:
  - Entender comandos como `kubectl get pods`, `kubectl logs`, `kubectl describe`, e `kubectl rollout` antes de usar ferramentas como **Lens** ou **K9s**.
  - O alias `k` deve ser adotado após familiaridade com `kubectl`.
- **Uso de Ferramentas Gráficas**:
  - Ferramentas como **Lens** são ideais para visualização e debugging, mas não substituem o entendimento do Kubernetes.
  - Instalar o **Metrics Server** para habilitar métricas de CPU/memória no **Lens**.
- **Controle de Versão**:
  - Evitar `latest` em imagens de containers; usar tags específicas para garantir rollbacks confiáveis.
  - Configurar `imagePullPolicy: Always` em produção para garantir que a imagem correta seja baixada.
- **Redundância e Afinidade**:
  - Distribuir **Pods** entre múltiplos nós (usando **afinidade** ou **anti-afinidade**) para maior resiliência.
  - O **Lens** ajuda a visualizar essa distribuição.
- **Documentação**:
  - Consultar a documentação oficial do Kubernetes (kubernetes.io) para aprofundar conceitos.
  - Revisar aulas e reassistir vídeos para consolidar o aprendizado.

## Próximos Módulos do Curso de DevOps
- **Feature Flags**:
  - Introdução ao uso de *feature flags* para gerenciar funcionalidades em aplicações.
- **Cost Management**:
  - Estratégias para monitoramento e otimização de custos em ambientes de nuvem.
- **Blue-Green Deployment**:
  - Uso de **Argo Rollouts** para implantações **blue-green**, permitindo atualizações sem downtime.
  - Continuação do uso de Kubernetes, conectando com conceitos do módulo atual.

## Conclusão
A aula encerra o módulo de Kubernetes destacando duas dicas práticas: o alias `k` para `kubectl` e a ferramenta **Lens**, uma IDE para visualização e gerenciamento de clusters. O **Lens** oferece uma interface gráfica para monitorar **Pods**, **Deployments**, **Services**, **ConfigMaps**, e **Secrets**, além de facilitar rollbacks e acesso a logs. O alias `k` reduz a digitação, enquanto o **Lens** e o **K9s** aumentam a produtividade, mas o domínio do `kubectl` é essencial. A aula reforça a importância de evitar a tag `latest` em imagens para garantir rollbacks confiáveis e destaca a documentação oficial como recurso complementar. O módulo, o maior do curso de DevOps, focou em aplicações **stateless**, e os próximos módulos abordarão **Feature Flags**, **Cost Management**, e **Blue-Green Deployment** com **Argo Rollouts**.